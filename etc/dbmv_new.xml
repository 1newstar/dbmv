<?xml version="1.0" encoding="ISO-8859-1"?>
<dbmv>

  <teradata>
    <select id="tbDefinition">
      SELECT        c.DatabaseName as "scname", cast(c.TableName as varchar(40)) as "tbname", c.ColumnName as "clname", 
case when c.ColumnType = 'A1' THEN 'ARRAY'
WHEN c.ColumnType = 'AN' THEN 'MULTI-DIMENSIONAL ARRAY' WHEN c.ColumnType = 'AT' THEN 'TIME' WHEN c.ColumnType = 'BF' THEN 'BYTE' WHEN c.ColumnType = 'BO' THEN 'BLOB'
WHEN c.ColumnType = 'BV' THEN 'VARBYTE' WHEN c.ColumnType = 'CF' THEN 'CHARACTER' WHEN c.ColumnType = 'CO' THEN 'CLOB' WHEN c.ColumnType = 'CV' THEN 'VARCHAR'
WHEN c.ColumnType = 'D' THEN 'DECIMAL' WHEN c.ColumnType = 'DA' THEN 'DATE' WHEN c.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR' WHEN c.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
WHEN c.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND' WHEN c.ColumnType = 'DY' THEN 'INTERVAL DAY' WHEN c.ColumnType = 'F' THEN 'FLOAT' WHEN c.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
WHEN c.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND' WHEN c.ColumnType = 'HR' THEN 'INTERVAL HOUR' WHEN c.ColumnType = 'I' THEN 'INTEGER' WHEN c.ColumnType = 'I1' THEN 'BYTEINT'
WHEN c.ColumnType = 'I2' THEN 'SMALLINT' WHEN c.ColumnType = 'I8' THEN 'BIGINT' WHEN c.ColumnType = 'JN' THEN 'JSON' WHEN c.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
WHEN c.ColumnType = 'MO' THEN 'INTERVAL MONTH' WHEN c.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND' WHEN c.ColumnType = 'N' THEN 'NUMBER' WHEN c.ColumnType = 'PD' THEN 'PERIOD(DATE)'
WHEN c.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP WITH TIME ZONE)' WHEN c.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP)' WHEN c.ColumnType = 'PT' THEN 'PERIOD(TIME)' WHEN c.ColumnType = 'PZ' THEN 'PERIOD(TIME WITH TIME ZONE)'
WHEN c.ColumnType = 'SC' THEN 'INTERVAL SECOND' WHEN c.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE' WHEN c.ColumnType = 'TS' THEN 'TIMESTAMP' WHEN c.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
WHEN c.ColumnType = 'UT' THEN 'UDT Type' WHEN c.ColumnType = 'XM' THEN 'XML' WHEN c.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH' WHEN c.ColumnType = 'YR' THEN 'INTERVAL YEAR'
WHEN c.ColumnType = '++' THEN 'TD_ANYTYPE' ELSE 'n/a'
END  as "tyname",
               (CASE WHEN c.DecimalTotalDigits IS NOT NULL THEN c.DecimalTotalDigits
                ELSE c.ColumnLength END) as "precision", 
               (CASE WHEN c.DecimalFractionalDigits  IS  NOT NULL THEN cast(c.DecimalFractionalDigits as varchar(10))    ELSE ''  END)  as "scale", 
               (CASE c.Nullable     WHEN 'N'      THEN 'NOT NULL' ELSE '' END)  as "isnull", 
               (CASE WHEN c.DefaultValue IS  NOT NULL THEN  
                   (CASE WHEN TO_NUMBER(c.DefaultValue) IS NOT NULL THEN cast(c.DefaultValue as integer)  ELSE 
                       (CASE WHEN UPPER(c.DefaultValue) = 'TIME' THEN 0 else 
                           (CASE WHEN UPPER(c.DefaultValue) = 'CURRENT TIMESTAMP(6)' THEN 'CURRENT_TIMESTAMP' ELSE 
                              (CASE WHEN LEFT(c.DefaultValue,2) = ''' ' THEN ''' ''' ELSE 
                                  (CASE WHEN c.ColumnType = 'CF' THEN DECODE(c.DefaultValue, 'N', '''N''','Y','''Y''',c.DefaultValue) ELSE c.DefaultValue 
                                   END) 
                               END) 
                            END) 
                        END) 
                    END) 
               ELSE  c.DefaultValue END) as "dfval"
      FROM     DBC.Columns c, DBC.Tables t
      WHERE    c.CreatorName  = USER
	  AND    ('${schema_filter}' = '' OR  '${schema_filter}' = c.DatabaseName)
	  AND      c.CreatorName  = t.CreatorName
       --   AND c.DatabaseName = 'vwuser'
      AND      c.DatabaseName = t.DatabaseName
      AND      c.TableName    = t.TableName
      AND      c.columnType  NOT IN ('N')
      AND      t.TableKind    IN ( 'O','T' )
      ORDER BY 1, 2, c.ColumnId
    </select>
	<select id="viwDefinition">
      SELECT   t.DatabaseName as "scname", t.TableName as "viwname", v.CreateText as "viwdef", 'N' as "viewchk", 'N' as "viwupd"
    
      FROM     DBC.tvm v, DBC.Tables t
      WHERE    (t.CreatorName  = 'DO NOT USE USER' OR t.CreatorName = '${schema_filter}')
	  AND    ('${schema_filter}' = '' OR  '${schema_filter}' = t.DatabaseName)
      AND      t.TableName    = v.TvmName
      AND      t.TableKind    = 'V'
      ORDER BY 1, 2, 3
	  
    </select>
    <select id="fkDefinition">
      SELECT ChildDB  as scname , ChildTable  as tbname,  IndexName as csname, ChildKeyColumn as clname, 
             ParentDB as rscname, ParentTable as rtbname, ParentKeyColumn as rclname
      FROM   DBC.All_RI_Parents
      WHERE  CreatorName  = USER
      ORDER BY 1,2,3,IndexID
    </select>
    <select id="ukDefinition">
      SELECT DatabaseName as scname, TableName as tbname, IndexName as csname, 
             (CASE  IndexType WHEN 'K'  THEN 'PRIMARY KEY'
              ELSE                           'UNIQUE'
              END) as cstype,
             ColumnName as clname,
             '' as delrule
      FROM  DBC.indices
      WHERE CreatorName  = USER
	  AND    ('${schema_filter}' = '' OR  '${schema_filter}' = DatabaseName)
      AND  IndexType  IN ('K', 'U')
      ORDER BY 1,2,3,ColumnPosition
    </select>
    <select id="ixDefinition">
      SELECT DatabaseName as scname, TableName as tbname, DatabaseName as iscname, IndexName as ixname, 
             IndexType    as ixtype, 
             NULL         as ixuniq,
             ColumnName   as cname 
      FROM  DBC.indices 
      WHERE CreatorName  = USER
	  AND    ('${schema_filter}' = '' OR  '${schema_filter}' = DatabaseName)
      AND  IndexType  NOT IN ('K', 'U', 'J', '1', '2')
      AND  IndexName IS NOT NULL
      ORDER BY 1,2,3,ColumnPosition
    </select>

    <create id="sch">
    </create>
    <create id="tb">
      CREATE MULTISET TABLE "${tbname}" (
         "${clname}"	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT "${csname}"	${cstype} ( ${clname} ):
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT "${csname}"	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname}( ${clname} ) ON ${tbname} 
    </create>
  </teradata>

  <oracle>
    <select id="tbDefinition">
      SELECT   c.owner as "scname", c.table_name as "tbname", c.column_name as "clname", 
               (CASE 
                   WHEN c.data_type IN ('NUMERIC', 'NUMBER', 'DECIMAL') 
                        AND c.data_precision IS NULL AND c.data_scale IS NULL 
                      THEN 'INTEGER'
                   WHEN c.data_type IN ('FLOAT') AND c.data_precision &gt;= 10  AND c.data_precision &lt; 20
                      THEN 'BINARY_DOUBLE'      
                   WHEN c.data_type IN ('FLOAT') AND c.data_precision &lt; 10 
                      THEN 'BINARY_FLOAT'      
                   WHEN c.data_type LIKE 'TIMESTAMP%'
                      THEN REGEXP_REPLACE(c.data_type, '\([0-9]+\)', '%')
                ELSE 
                   c.data_type
                END) as "tyname", 
               cast(NVL(c.data_precision, c.data_length) as number(6,0))            as "precision", 
               cast(NVL(c.data_scale,0) as number(6,0))                             as "scale", 
               DECODE(c.nullable, 'N', 'NOT NULL', 'Y', NULL)  as "isnull", 
               c.data_default as "dfval"
      FROM     all_tab_columns c, all_tables t
      WHERE    c.owner      = USER
      AND      c.owner      = t.owner
      AND      c.table_name = t.table_name
      AND      c.table_name NOT LIKE 'SYS_%'
      AND      t.secondary  = 'N'
      AND      t.nested     = 'NO'
      ORDER BY 1, 2, c.column_id
    </select>
	  <select id="viwDefinition">
      SELECT DISTINCT s.table_schema scname, s.table_name viwname, s.view_definition viwdef, s.check_option viwchk , s.is_updatable viwupd
      FROM (SELECT ora_database_name AS TABLE_CATALOG, 	sys_context( 'userenv', 'current_schema' ) AS TABLE_SCHEMA, view_name AS TABLE_NAME,
      CONCAT(CONCAT(CONCAT('CREATE VIEW ', view_name), ' AS '),TEXT_VC) AS VIEW_DEFINITION,
	  CAST (CASE WHEN text_vc like '%WITH%CHECK%OPTION%' then  '/*CHECK_OPTIONi=YES*/' 
		ELSE '/*CHECK_OPTION=NONE*/' END as varchar2(40)) AS CHECK_OPTION, 'IS_UPDATABLE=NO ' AS IS_UPDATABLE FROM user_views ) s
      ORDER BY 1,2,3
    </select>
    <select id="fkDefinition">
      SELECT cl1.owner  as scname, cl1.table_name  as tbname, cl1.constraint_name as csname, cl1.column_name as clname, 
             cl2.owner as rscname, cl2.table_name as rtbname, cl2.column_name as rclname,
             cast((CASE delete_rule WHEN 'SET NULL' THEN 'ON DELETE SET NULL' 
                                     WHEN 'NO ACTION' THEN '' 
                                     WHEN 'CASCADE' THEN 'ON DELETE CASCADE ' 
                                     ELSE '' END) as varchar2(20)) as delrule
      FROM   all_constraints cs, all_cons_columns cl1, all_cons_columns cl2
      WHERE  cs.owner             = USER
      AND    cs.constraint_type   = 'R'
      AND    cs.owner             = cl1.owner 
      AND    cs.table_name        = cl1.table_name
      AND    cs.constraint_name   = cl1.constraint_name
      AND    cs.r_owner           = cl2.owner
      AND    cs.r_constraint_name = cl2.constraint_name
      AND    cl1.position         = cl2.position
      ORDER BY 1, 2, 3, cl1.position
    </select>
    <select id="ukDefinition">
      SELECT cast(lower(replace(cs.owner,'#','')) as varchar2(40))  as scname, cast(cs.table_name as varchar2(40)) as tbname, replace(cs.constraint_name,'.','') as csname, 
             cast((CASE  cs.constraint_type WHEN 'P'  THEN 'PRIMARY KEY'
              ELSE                                    'UNIQUE'
              END) as varchar2(20)) as cstype,
              cast(cl.column_name as varchar2(40)) as clname,
              cast((CASE delete_rule WHEN 'SET NULL' THEN 'ON DELETE SET NULL' 
                                     WHEN 'NO ACTION' THEN '' 
                                     WHEN 'CASCADE' THEN 'ON DELETE CASCADE ' 
                                     ELSE '' END) as varchar2(20)) as delrule
      FROM  all_constraints cs, all_cons_columns cl 
      WHERE cs.owner            = USER
      AND   cs.constraint_type IN ('P', 'U')
      AND   cs.constraint_name NOT LIKE 'BIN$%==%'
      AND   cs.owner           = cl.owner
      AND   cs.constraint_name = cl.constraint_name
      AND   cs.table_name      = cl.table_name
      ORDER BY 1, 2, 3, cl.position
    </select>
    <select id="ixDefinition">
      SELECT ix.table_owner as scname, ix.table_name as tbname, ix.owner as iscname, ix.index_name as ixname, 
             CASE  WHEN ix.index_type IN ('NORMAL', 'BITMAP') THEN 'BTREE' ELSE CAST(ix.index_type AS VARCHAR(2))  END as ixtype, 
             DECODE(ix.uniqueness, 'UNIQUE', 'UNIQUE')  as ixuniq,
             id.column_name   as cname 
      FROM  all_indexes ix, all_ind_columns id
      WHERE ix.owner      = USER
      AND   ix.owner      = id.index_owner
      AND   ix.index_name = id.index_name
      AND   ix.table_owner= id.table_owner
      AND   ix.table_name = id.table_name 
      AND   ix.index_name NOT LIKE 'BIN$%==%'
      AND   ix.index_name NOT IN ( 
               SELECT constraint_name FROM all_constraints cs
               WHERE cs.owner      = ix.owner
               AND   cs.table_name = ix.table_name
               AND   cs.constraint_type IN ('P', 'U', 'R')
               )
      ORDER BY 1,2,3,id.column_position
    </select>

    <create id="sch">
    </create>
    <create id="tb">
      CREATE MULTISET TABLE "${tbname}" (
         "${clname}"	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT "${csname}"	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT "${csname}"	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname}( ${clname} ) ON ${tbname} 
    </create>
  </oracle>

  <asa>
    <select id="tbDefinition">
      SELECT   suser_name() as "scname", t.table_name as "tbname", c.column_name as "clname", d.domain_name as "tyname", 
               c.width as "precision", c.scale as "scale", 
               CASE  WHEN c.nulls = 'N' THEN 'NOT NULL'   END CASE as "isnull", 
               CASE  WHEN c.[default]  IS NOT NULL THEN  'DEFAULT ' || c.[default]  END CASE as "dfval"
      FROM     systab t, systabcol c, sysdomain d
      WHERE    t.creator  = suser_id()
      AND      t.table_id = c.table_id
      AND      c.domain_id= d.domain_id
      ORDER BY 1, 2, c.column_id
    </select>
    <select id="fkDefinition">
    </select>
    <select id="ukDefinition">
    </select>
    <select id="ixDefinition">
    </select>
  </asa>

  <mysql>
    <select id="tbDefinition">
      SELECT c.table_schema as "scname", c.table_name as "tbname", c.column_name as "clname", c.data_type as "tyname",
             IF(LOWER(c.data_type) LIKE '%CHAR%', character_maximum_length, c.numeric_precision) as "precision", 
             c.numeric_scale as "scale",
             IF(c.is_nullable = 'YES', '', 'NOT NULL') as "isnull",
             IF(c.column_default IS NOT NULL, IF (c.data_type LIKE '%char%', QUOTE(c.column_default), c.column_default), NULL) as "defval"
      FROM   information_schema.columns c
      WHERE  c.table_schema IN (SELECT db FROM information_schema.processlist)
      ORDER BY c.table_schema, c.table_name, c.ordinal_position
    </select>
    <select id="fkDefinition">
      SELECT table_schema as scname , table_name  as tbname,  constraint_name as csname, column_name as clname, 
             referenced_table_schema as rscname, referenced_table_name as rtbname, referenced_column_name as rclname
      FROM   information_schema.key_column_usage
      WHERE  table_schema IN (SELECT db FROM information_schema.processlist)
      AND    position_in_unique_constraint IS NOT NULL
      ORDER BY 1,2,3,ordinal_position
    </select>   
    <select id="ukDefinition">
      SELECT table_schema as scname, table_name as tbname,
             (CASE
                WHEN constraint_name = 'PRIMARY'   THEN CONCAT('pk_', table_name)
                WHEN constraint_name = column_name THEN CONCAT(CONCAT('uk_', table_name), column_name)
                ELSE constraint_name
             END) as csname,
             (CASE constraint_name WHEN 'PRIMARY' THEN 'PRIMARY KEY' ELSE 'UNIQUE' END) as cstype,
             column_name as clname,
             '' as delrule
       FROM  information_schema.key_column_usage
       WHERE table_schema IN (SELECT db FROM information_schema.processlist)
       AND   position_in_unique_constraint IS NULL
       ORDER BY 1,2,3,ordinal_position
    </select>
    <select id="ixDefinition">
      SELECT table_schema as scname, table_name as tbname, index_schema as iscname, index_name as ixname, 
             index_type   as ixtype, 
             NULL         as ixuniq,
             column_name  as cname 
      FROM  information_schema.statistics
      WHERE table_schema IN (SELECT db FROM information_schema.processlist)
      AND   non_unique = 1
      ORDER BY 1,2,3,seq_in_index
    </select>

    <create id="sch">
      CREATE DATABASE ${scname} CHARACTER SET = utf8
    </create>
    <create id="tb">
      CREATE TABLE ${scname}.${tbname} (
         ${clname}	${tyname}	${isnull}	
      )
    </create>
    <create id="uk">
      ALTER TABLE ${scname}.${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${scname}.${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rscname}.${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${scname}.${tbname} ( ${clname} )
    </create>
  </mysql>

  <db2>
    <select id="tbDefinition">
      SELECT t.creator as scname, t.name as tbname, c.name as clname, 
             CASE 
                WHEN c.coltype IN ('NUMERIC', 'DECIMAL') AND c.length &lt; 10 AND c.scale = 0                      THEN 'INTEGER'
                WHEN c.coltype IN ('NUMERIC', 'DECIMAL') AND c.length &gt;=10 AND c.length &lt; 18 AND c.scale = 0 THEN 'BIGINT'
                ELSE c.coltype
             END as  tyname,
             c.length as precision, 
             c.scale,
             CASE WHEN c.nulls = 'N' THEN 'NOT NULL' END as isnull, 
             CASE WHEN c.default != '' THEN c.default END as defval
      FROM   sysibm.systables t, sysibm.syscolumns c
      WHERE  t.creator = c.tbcreator
      AND    t.name    = c.tbname
      AND    t.creator NOT IN ('SYSCAT','SYSIBM','SYSIBMADM','SYSSTAT','SYSTOOLS')
      ORDER BY scname, tbname, colno
    </select>

    <select id="fkDefinition">
      SELECT r.creator as scname, r.tbname as tbname, r.relname as csname, k1.colname as clname,
             r.reftbcreator as rscname, k2.tbname as rtbname, k2.colname as rclname
      FROM   sysibm.sysrels r, sysibm.syskeycoluse k1, sysibm.syskeycoluse k2
      WHERE  r.creator      = k1.tbcreator
      AND    r.tbname       = k1.tbname 
      AND    r.relname      = k1.constname
      AND    r.reftbcreator = k2.tbcreator
      AND    r.reftbname    = k2.tbname
      AND    r.refkeyname   = k2.constname
      AND    k1.colseq      = k2.colseq
      AND    r.creator NOT IN ('SYSCAT','SYSIBM','SYSIBMADM','SYSSTAT','SYSTOOLS')
      ORDER BY 1,2,3,k1.colseq
    </select>
    <select id="ukDefinition">
      SELECT i.tbcreator as scname, i.tbname as tbname, i.name  as csname,
             CASE 
                WHEN i.uniquerule IN ('U') THEN 'UNIQUE'
                WHEN i.uniquerule IN ('P') THEN 'PRIMARY KEY'
             END as cstype, k.colname as clname
             '' as delrule
      FROM   sysibm.sysindexes i, sysibm.syskeycoluse k
      WHERE  i.creator = k.tbcreator
      AND    i.tbname  = k.tbname
      AND    i.creator NOT IN ('SYSCAT','SYSIBM','SYSIBMADM','SYSSTAT','SYSTOOLS')
      AND    i.uniquerule IN ('U','P')
      ORDER BY 1,2,3,k.colseq
    </select>
    <select id="ixDefinition">
     SELECT i.tbcreator as scname, i.tbname as tbname, i.creator as iscname, i.name as ixname,
             'BTREE'    as ixtype,
             NULL       as ixuniq,
             k.colname  as cname
      FROM   sysibm.sysindexes i, sysibm.syskeycoluse k
      WHERE  i.creator = k.tbcreator
      AND    i.tbname  = k.tbname
      AND    i.creator    NOT IN ('SYSCAT','SYSIBM','SYSIBMADM','SYSSTAT','SYSTOOLS')
      AND    i.uniquerule NOT IN ('U','P')
      ORDER BY 1,2,3,k.colseq
    </select>

    <create id="sch">
      CREATE DATABASE ${scname}
    </create>
    <create id="tb">
      CREATE TABLE "${tbname}" (
         "${clname}"	${tyname}	${isnull}	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${tbname} ( ${clname} )
    </create>
  </db2>

  <mssql>
    <select id="tbDefinition">
      SELECT s.name as scname, o.name as tbname, c.name as clname, t.name as  tyname, 
             c.prec as precision, c.scale, 
             CASE  WHEN c.isnullable = 0 THEN 'NOT NULL'   END as isnull, 
             CASE  WHEN c.cdefault  != 0 THEN  (SELECT REPLACE(REPLACE(text, '(', ''),')', '') FROM syscomments WHERE id = c.cdefault)  END as dfval
      FROM   sys.objects o, syscolumns c, systypes t, sys.schemas s
      WHERE  o.object_id    = c.id
      AND    o.schema_id = s.schema_id
      AND    o.type  = 'U'
      AND    c.xtype = t.xtype
      AND    user_name(t.uid) = 'sys'
      AND    t.name NOT IN ('sysname', 'SQL_VARIANT', 'BITEA', '${types_to_skip}')
      AND    ('${schema_filter}' = '' OR  '${schema_filter}' = s.name)
      ORDER BY s.name, o.name, c.colid
    </select>
    <select id="viwDefinition">
      SELECT DISTINCT u.view_schema scname, u.view_name viwname, s.view_definition viwdef, s.check_option viwchk , s.is_updatable viwupd
      FROM (SELECT DB_NAME() AS TABLE_CATALOG, SCHEMA_NAME(schema_id)	AS TABLE_SCHEMA, name AS TABLE_NAME,
		OBJECT_DEFINITION(object_id) 
	 AS VIEW_DEFINITION,
	convert(varchar(40), CASE with_check_option
		WHEN 1 THEN    '/*CHECK_OPTION=CASCADE*/'
		ELSE '/*CHECK_OPTION=NONE*/' END) AS CHECK_OPTION, 'IS_UPDATABLE=NO ' AS IS_UPDATABLE FROM sys.views WHERE OBJECT_DEFINITION(object_id) NOT LIKE '%.value%;%' ) s, 
          [INFORMATION_SCHEMA].[VIEW_TABLE_USAGE] u
      WHERE s.table_name = u.view_name
      AND s.table_schema = u.view_schema
      AND u.table_schema = u.view_schema
      AND    ('${schema_filter}' = '' OR  '${schema_filter}' = u.view_schema)
      ORDER BY 1,2,3
    </select>
    <select id="fkDefinition">
      SELECT s1.name as scname, o1.name as tbname, o2.name as csname, c1.name as clname, 
             s2.name rscname, o3.name as rtbname, c2.name as rclname
      FROM   sys.schemas s1, sys.objects o1, sysobjects o2, sysforeignkeys f, 
             syscolumns c1, syscolumns c2, sys.schemas s2, sys.objects o3 
      WHERE  o1.schema_id = s1.schema_id
      AND    o1.object_id = o2.parent_obj
      AND    o2.xtype     = 'F'
      AND    f.constid    = o2.id
      AND    f.fkeyid     = c1.id
      AND    f.fkey       = c1.colid 
      AND    f.rkeyid     = c2.id
      AND    f.rkey       = c2.colid
      AND    f.rkeyid     = o3.object_id
      AND    o3.schema_id = s2.schema_id
      AND    ('${schema_filter}' = '' OR ('${schema_filter}' = s1.name AND '${schema_filter}' = s2.name))
      ORDER BY 1,2,3,f.keyno
    </select>
    <select id="ukDefinition">
      select distinct * FROM (SELECT  s.name as scname, o1.name as tbname, o2.name as csname, 
             CASE  o2.xtype WHEN 'PK'  THEN 'PRIMARY KEY'
                            WHEN 'UQ'  THEN 'UNIQUE'
             END as cstype,
              substring(STUFF(( SELECT distinct  '","'+ c.name  FROM  sysobjects o2, sysindexes i, sysindexkeys ik, syscolumns c
      WHERE  o1.schema_id = s.schema_id
      AND    o1.object_id = o2.parent_obj
      AND    o1.object_id = i.id
      AND    o2.name      = i.name
      AND    i.id         = ik.id
      AND    i.indid      = ik.indid
      AND    ik.id        = c.id
      AND    ik.colid     = c.colid
      AND    o2.xtype  IN ('PK','UQ')
      ORDER BY 1 FOR XML PATH('')),1 ,1, ''),3,128) as clname
      FROM   sys.schemas s, sys.objects o1, sysobjects o2, sysindexes i, sysindexkeys ik, syscolumns c
      WHERE  o1.schema_id = s.schema_id
      AND    o1.object_id = o2.parent_obj
      AND    o1.object_id = i.id
      AND    o2.name      = i.name
      AND    i.id         = ik.id
      AND    i.indid      = ik.indid
      AND    ik.id        = c.id
      AND    ik.colid     = c.colid
      AND    o2.xtype  IN ('PK','UQ')
      AND    ('${schema_filter}' = '' OR  '${schema_filter}' = s.name)
      ) tmp
	  ORDER BY 1,2,3
    </select>
    <select id="ixDefinition">
      SELECT s.name as scname, o1.name as tbname, s.name as iscname, i.name as ixname, 
             CASE  WHEN i.type      = 2 THEN 'BTREE' ELSE CAST(i.type AS VARCHAR(2))  END as ixtype, 
             CASE  WHEN i.is_unique = 1 THEN 'UNIQUE'                                 END as ixuniq,
                c.name as cname
      FROM   sys.schemas s, sys.objects o1,  sys.indexes i, sysindexkeys ik, syscolumns c
      WHERE  o1.schema_id            = s.schema_id
      AND    o1.type                 = 'U' 
      AND    o1.object_id            = i.object_id
      AND    i.is_primary_key       != 1
      AND    i.is_unique_constraint != 1 
      AND    i.index_id              = ik.indid
      AND    i.object_id             = ik.id
      AND    ik.id                   = c.id
      AND    ik.colid                = c.colid
      AND    ('${schema_filter}' = '' OR  '${schema_filter}' = s.name)
      ORDER BY 1,2,3, ik.keyno
    </select>
   </mssql>

  <netezza>
       <select id="DGCtbDefinition">
      SELECT   c.owner as "scname", c.table_name as "tbname", c.column_name as "clname", 
               (CASE 
                   WHEN c.data_type IN ('NUMERIC', 'NUMBER', 'DECIMAL') 
                        AND c.data_precision IS NULL AND c.data_scale IS NULL 
                      THEN 'INTEGER'
                   WHEN c.data_type IN ('FLOAT') AND c.data_precision &gt;= 10  AND c.data_precision &lt; 20
                      THEN 'BINARY_DOUBLE'      
                   WHEN c.data_type IN ('FLOAT') AND c.data_precision &lt; 10 
                      THEN 'BINARY_FLOAT'      
                   WHEN c.data_type LIKE 'TIMESTAMP%'
                      THEN REGEXP_REPLACE(c.data_type, '\([0-9]+\)', '%')
                ELSE 
                   c.data_type
                END) as "tyname", 
               cast(NVL(c.data_precision, c.data_length) as number(6,0))            as "precision", 
               cast(NVL(c.data_scale,0) as number(6,0))                             as "scale", 
               DECODE(c.nullable, 'N', 'NOT NULL', 'Y', NULL)  as "isnull", 
               c.data_default as "dfval"
      FROM     all_tab_columns c, all_tables t
      WHERE    c.owner      = USER
      AND      c.owner      = t.owner
      AND      c.table_name = t.table_name
      AND      c.table_name NOT LIKE 'SYS_%'
      AND      t.secondary  = 'N'
      AND      t.nested     = 'NO'
      ORDER BY 1, 2, c.column_id
    </select>
	  <select id="viwDefinition">
      SELECT DISTINCT v.owner AS scname, v.viewname AS viwname, v.definition  AS viwdef, 'N' AS viwchk , 'N' AS viwupd
      FROM _v_view v
	  WHERE objtype= 'VIEW'
      ORDER BY 1,2,3
    </select>
    <select id="DGCfkDefinition">
      SELECT cl1.owner  as scname, cl1.table_name  as tbname, cl1.constraint_name as csname, cl1.column_name as clname, 
             cl2.owner as rscname, cl2.table_name as rtbname, cl2.column_name as rclname,
             cast((CASE delete_rule WHEN 'SET NULL' THEN 'ON DELETE SET NULL' 
                                     WHEN 'NO ACTION' THEN '' 
                                     WHEN 'CASCADE' THEN 'ON DELETE CASCADE ' 
                                     ELSE '' END) as varchar2(20)) as delrule
      FROM   all_constraints cs, all_cons_columns cl1, all_cons_columns cl2
      WHERE  cs.owner             = USER
      AND    cs.constraint_type   = 'R'
      AND    cs.owner             = cl1.owner 
      AND    cs.table_name        = cl1.table_name
      AND    cs.constraint_name   = cl1.constraint_name
      AND    cs.r_owner           = cl2.owner
      AND    cs.r_constraint_name = cl2.constraint_name
      AND    cl1.position         = cl2.position
      ORDER BY 1, 2, 3, cl1.position
    </select>
    <select id="DGCukDefinition">
      SELECT cast(lower(replace(cs.owner,'#','')) as varchar2(40))  as scname, cast(cs.table_name as varchar2(40)) as tbname, replace(cs.constraint_name,'.','') as csname, 
             cast((CASE  cs.constraint_type WHEN 'P'  THEN 'PRIMARY KEY'
              ELSE                                    'UNIQUE'
              END) as varchar2(20)) as cstype,
              cast(cl.column_name as varchar2(40)) as clname,
              cast((CASE delete_rule WHEN 'SET NULL' THEN 'ON DELETE SET NULL' 
                                     WHEN 'NO ACTION' THEN '' 
                                     WHEN 'CASCADE' THEN 'ON DELETE CASCADE ' 
                                     ELSE '' END) as varchar2(20)) as delrule
      FROM  all_constraints cs, all_cons_columns cl 
      WHERE cs.owner            = USER
      AND   cs.constraint_type IN ('P', 'U')
      AND   cs.constraint_name NOT LIKE 'BIN$%==%'
      AND   cs.owner           = cl.owner
      AND   cs.constraint_name = cl.constraint_name
      AND   cs.table_name      = cl.table_name
      ORDER BY 1, 2, 3, cl.position
    </select>
    <select id="DGCixDefinition">
      SELECT ix.table_owner as scname, ix.table_name as tbname, ix.owner as iscname, ix.index_name as ixname, 
             CASE  WHEN ix.index_type IN ('NORMAL', 'BITMAP') THEN 'BTREE' ELSE CAST(ix.index_type AS VARCHAR(2))  END as ixtype, 
             DECODE(ix.uniqueness, 'UNIQUE', 'UNIQUE')  as ixuniq,
             id.column_name   as cname 
      FROM  all_indexes ix, all_ind_columns id
      WHERE ix.owner      = USER
      AND   ix.owner      = id.index_owner
      AND   ix.index_name = id.index_name
      AND   ix.table_owner= id.table_owner
      AND   ix.table_name = id.table_name 
      AND   ix.index_name NOT LIKE 'BIN$%==%'
      AND   ix.index_name NOT IN ( 
               SELECT constraint_name FROM all_constraints cs
               WHERE cs.owner      = ix.owner
               AND   cs.table_name = ix.table_name
               AND   cs.constraint_type IN ('P', 'U', 'R')
               )
      ORDER BY 1,2,3,id.column_position
    </select>
    
    <create id="sch">
      CREATE DATABASE ${scname}
    </create>
    <create id="tb">
      CREATE TABLE ${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${tbname} ( ${clname} )
    </create>
  </netezza>

   <postgres>
      <select id="tbDefinition">
         SELECT c.table_schema as "scname", 
                c.table_name as "tbname", c.column_name as "clname", 
                CASE WHEN c.data_type = 'numeric' AND c.numeric_precision IS NULL THEN 'DOUBLE PRECISION' ELSE c.data_type  END as "tyname",
                CASE WHEN LOWER(c.data_type) LIKE '%char%' THEN character_maximum_length ELSE c.numeric_precision END as "precision", 
                c.numeric_scale as "scale",
                CASE WHEN c.is_nullable = 'YES' THEN '' ELSE 'NOT NULL' END as "isnull",
                CASE WHEN c.column_default IS NOT NULL 
                THEN 
                   CASE WHEN LOWER(c.column_default) LIKE '%char%'   THEN substring(c.column_default from '(.*)::.*char.*')
                        WHEN LOWER(c.column_default) LIKE '%text%'   THEN substring(c.column_default from '(.*)::.*text.*') 
                        WHEN LOWER(c.column_default) LIKE 'nextval%' THEN NULL 
                        WHEN LOWER(c.column_default) =    'now()'    THEN 'current_timestamp' 
                   ELSE c.column_default END
                 ELSE 
                    NULL
                 END as "defval"
         FROM   information_schema.columns c
         WHERE  c.table_schema NOT IN ( 'information_schema', 'pg_catalog')
         AND    c.table_catalog = current_database()
         AND    c.table_name IN ( SELECT table_name FROM information_schema.tables WHERE table_type IN ('BASE TABLE', 'LOCAL TEMPORARY') )
         ORDER BY c.table_schema, c.table_name, c.ordinal_position
    </select>
    <select id="fkDefinition">
       SELECT CASE WHEN k1.table_schema = 'public' THEN current_user ELSE k1.table_schema END as "scname",
              k1.table_name  as "tbname",  k1.constraint_name as "csname", k1.column_name as "clname", 
              CASE WHEN k2.table_schema = 'public' THEN current_user ELSE k2.table_schema END as "rscname", 
              k2.table_name as rtbname, k2.column_name as rclname
       FROM   information_schema.key_column_usage k1,
              information_schema.key_column_usage k2,
              information_schema.referential_constraints r
       WHERE  k1.table_schema NOT IN ( 'information_schema', 'pg_catalog') 
       AND    k1.table_catalog                 = current_database()
       AND    k1.table_name       IN ( SELECT table_name FROM information_schema.tables WHERE table_type IN ('BASE TABLE', 'LOCAL TEMPORARY') )
       AND    k1.table_catalog                 = k2.table_catalog
       AND    k1.table_catalog                 = r.constraint_catalog
       AND    k1.position_in_unique_constraint = k2.ordinal_position
       AND    K1.constraint_name               = r.constraint_name
       AND    r.unique_constraint_name         = K2.constraint_name
       AND    k1.position_in_unique_constraint IS NOT NULL
       ORDER BY 1, 2, 3, k1.ordinal_position
    </select>   
    <select id="ukDefinition">
       SELECT CASE WHEN k.table_schema = 'public' THEN current_user ELSE k.table_schema END as "scname", 
              k.table_name as tbname,
             (CASE
                WHEN k.constraint_name IN ('PRIMARY', 'PRIMARY KEY') AND c.constraint_type = 'PRIMARY KEY' 
                   THEN CONCAT('pk_', k.table_name)
                WHEN c.constraint_type = k.column_name               
                   THEN CONCAT(CONCAT('uk_', k.table_name), k.column_name)
                ELSE k.constraint_name
             END) as csname,
             c.constraint_type as cstype,
             k.column_name as clname,
             '' as delrule
        FROM  information_schema.key_column_usage k,
             information_schema.table_constraints c
        WHERE k.table_schema NOT IN ( 'information_schema', 'pg_catalog')
        AND   k.table_catalog   = current_database()
        AND   k.table_name        IN ( SELECT table_name FROM information_schema.tables WHERE table_type IN ('BASE TABLE', 'LOCAL TEMPORARY') )
        AND   k.table_schema    = c.table_schema
        AND   k.table_name      = c.table_name
        AND   k.constraint_name = c.constraint_name
        AND   k.position_in_unique_constraint IS NULL
        ORDER BY 1, 2, 3, k.ordinal_position
    </select>
	<select id="viwDefinition"> 
         SELECT nc.nspname  AS scname,
          c.relname  AS viwname,
          CASE WHEN pg_has_role(c.relowner, 'USAGE')
               THEN pg_get_viewdef(c.oid)
               ELSE null END AS viwdef,
         'NONE'  AS check_option,
         CASE WHEN EXISTS (SELECT 1 FROM pg_rewrite WHERE ev_class = c.oid AND ev_type = '2' AND is_instead)
                   AND EXISTS (SELECT 1 FROM pg_rewrite WHERE ev_class = c.oid AND ev_type = '4' AND is_instead)
              THEN 'YES'
              ELSE 'NO' END AS viwupd
          FROM pg_namespace nc, pg_class c
          WHERE c.relnamespace = nc.oid
          AND c.relkind = 'v'
          AND (NOT pg_is_other_temp_schema(nc.oid))
          AND (pg_has_role(c.relowner, 'USAGE')
               OR has_table_privilege(c.oid, 'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER')
               OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES') )
          AND nc.nspname  NOT IN ( 'information_schema', 'pg_catalog')
          AND c.relname != 'views'
          ORDER BY 1,2,3
</select>
    <select id="ixDefinition">
       SELECT CASE WHEN tsh.nspname = 'public' THEN current_user ELSE tsh.nspname END as "scname", 
              t.relname  as tbname, 
              CASE WHEN ish.nspname = 'public' THEN current_user ELSE ish.nspname END as "iscname", 
              i.relname   as ixname,
              'BTREE'     as ixtype,
              NULL        as ixuniq,
              a.attname   as cname
       FROM  pg_namespace tsh, pg_class t, pg_class i, pg_namespace ish, pg_index ix, pg_attribute a
       WHERE t.relnamespace  = tsh.oid
	   AND   tsh.nspname NOT IN ( 'information_schema', 'pg_catalog')
       AND   t.relkind       = 'r'
       AND   t.oid           = ix.indrelid
       AND   ix.indisunique  = 'f'
       AND   ix.indisprimary = 'f'
       AND   ix.indexrelid   = i.oid
       AND   i.relnamespace  = ish.oid
       AND   a.attrelid      = i.oid
       AND   a.attnum        = ANY(ix.indkey)
       ORDER BY 1,2,3, a.attnum
    </select>
    <create id="sch">
      CREATE SCHEMA ${scname}
    </create>
    <create id="tb">
      CREATE TABLE ${scname}.${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${scname}.${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${scname}.${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${scname}.${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${scname}.${tbname} ( ${clname} )
    </create>
  </postgres>

  <greenplum>
    <create id="sch">
      create database ${scname}
    </create>
    <create id="tb">
      CREATE TABLE ${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      ) DISTRIBUTED RANDOMLY
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${tbname} ( ${clname} )
    </create>
  </greenplum>

  <progress>
    <create id="sch">
      
    </create>
    <create id="tb">
      CREATE TABLE ${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${tbname} ( ${clname} )
    </create>
  </progress>

  <maxdb>
    <create id="sch">
     --
    </create>
    <create id="tb">
      CREATE TABLE ${tbname} (
         "${clname}"	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${tbname}	ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${ixname} ON ${tbname} ( ${clname} )
    </create>
  </maxdb>

  <hana>
    <create id="sch">
    </create>
    <create id="tb">
      CREATE TABLE ${scname}.${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${iscname}.${ixname} ON ${scname}.${tbname} ( ${clname} )
    </create>
  </hana>

   <iq>
    <select id="tbDefinition">
      SELECT USER as "scname", t.table_name as "tbname", c.column_name as "clname", d.domain_name as "tyname",
             c.width as "precision", 
             c.scale as "scale",
             (CASE WHEN c.nulls = 'N' THEN 'NOT NULL' ELSE null END) as "isnull",
             c.[default] as "defval"
      FROM   sys.systable t, sys.syscolumn c, sys.sysdomain d
      WHERE  t.creator    = user_id(USER)
      AND    t.table_type = 'BASE'
      AND    t.table_id   = c.table_id
      AND    c.domain_id  = d.domain_id
      ORDER BY 1, 2, c.column_id
    </select>
    <select id="fkDefinition">
      SELECT USER as scname , t1.table_name  as tbname,  f.role as csname, c1.column_name as clname, 
             suser_name(t2.creator) as rscname, t2.table_name as rtbname, c2.column_name as rclname
      FROM   sys.systable t1, sys.sysforeignkey f, sys.sysfkcol fc, sys.syscolumn c1, sys.syscolumn c2, sys.systable t2
      WHERE  t1.creator          = user_id(USER)
      AND    t1.table_id         = f.foreign_table_id
      AND    f.foreign_table_id  = fc.foreign_table_id
      AND    f.foreign_key_id    = fc.foreign_key_id
      AND    fc.foreign_table_id = c1.table_id
      AND    fc.foreign_column_id= c1.column_id
      AND    f.primary_table_id  = c2.table_id
      AND    fc.primary_column_id= c2.column_id
      AND    t2.table_id         = f.primary_table_id
      ORDER BY 1, 2, 3, fc.foreign_column_id
    </select>   
    <select id="ukDefinition">
      SELECT USER as scname, t.table_name as tbname,
             (CASE 
                WHEN i.index_name = t.table_name    THEN 'pk_'||LOWER(t.table_name)
                WHEN i.index_name LIKE '% UNIQUE %' THEN 'uk_'||LOWER(t.table_name)
                ELSE cs.constraint_name
              END) as csname,
             (CASE cs.constraint_type WHEN 'P' THEN 'PRIMARY KEY' ELSE 'UNIQUE' END) as cstype,
             c.column_name as clname,
             '' as delrule
       FROM  sys.systable t, sys.sysconstraint cs, sys.sysidx i, sys.sysidxcol cx, sys.syscolumn c
       WHERE t.creator     = user_id(USER)
       AND   t.object_id   = cs.table_object_id
       AND   cs.constraint_type in ('P', 'U')
       AND   i.table_id    = t.table_id
       AND   i.object_id   = cs.ref_object_id 
       AND   cx.table_id   = t.table_id
       AND   cx.index_id   = i.index_id
       AND   c.table_id    = t.table_id
       AND   c.column_id   = cx.column_id
       ORDER BY 1,2,3, cx.sequence
    </select>
    <select id="ixDefinition">
      SELECT USER as scname, t.table_name as tbname, USER as iscname, i.index_name as ixname, 
             'BTREE'      as ixtype, 
             NULL         as ixuniq,
             column_name  as cname 
      FROM  sys.systable t, sys.sysidx i, sys.sysidxcol cx, sys.syscolumn c
      WHERE t.creator  = user_id(USER)
      AND   i.table_id = t.table_id
      AND   i.object_id not IN (SELECT ref_object_id 
                                 FROM   sys.sysconstraint 
                                 WHERE  constraint_type IN ('P','U')
                                 AND    table_object_id = t.object_id )
      AND   i.index_name NOT LIKE 'ASIQ_IDX_%'
      AND   cx.table_id = t.table_id
      AND   cx.index_id = i.index_id
      AND   c.table_id  = t.table_id
      AND   c.column_id = cx.column_id
      ORDER BY 1,2,3,cx.sequence
    </select>

    <create id="sch">
    </create>
    <create id="tb">
      CREATE TABLE ${scname}.${tbname} (
         ${clname}	${tyname}	${isnull} 	${dfval}
      )
    </create>
    <create id="uk">
      ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
    </create>
    <create id="fk">
      ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rscname}.${rtbname} ( ${rclname} )
    </create>
    <create id="ix">
      CREATE ${ixuniq} INDEX ${iscname}.${ixname} ON ${scname}.${tbname} ( ${clname} )
    </create>
   </iq>  


   <ase>
       <create id="sch">
       </create>
       <create id="tb">
         CREATE TABLE ${scname}.${tbname} (
            ${clname}	${tyname}	${isnull} 	${dfval}
         )
      </create>
      <create id="uk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	${cstype} ( ${clname} )
      </create>
      <create id="fk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
      	REFERENCES ${rscname}.${rtbname} ( ${rclname} )
      </create>
      <create id="ix">
         CREATE ${ixuniq} INDEX ${iscname}.${ixname} ON ${scname}.${tbname} ( ${clname} )
      </create>
   </ase>  
   
  
   <vectorwise>
      <create id="sch">
         SET SESSION AUTHORIZATION ${scname}
      </create>
      <create id="pre">
         SET SESSION AUTHORIZATION ${scname}
         SET INSERTMODE ${insert_mode}
      </create>
      <create id="tb">
         CREATE TABLE ${scname}.${tbname} (
            ${clname}	${tyname}	${isnull} 	${dfval}
         )
       </create>
      <create id="drop">
         DROP TABLE IF EXISTS ${scname}.${tbname}
      </create>
       <create id="viw">
         DROP VIEW IF EXISTS ${scname}.${tbname}
       </create>
       <create id="seq">
         CREATE SEQUENCE ${scname}.${seqname} `
            ${clname} AS ${tyname} START WITH ${initv} INCREMENT BY  ${incv} MAXVALUE ${maxv} MINVALUE ${minv} ${seqtype} ${cachetype}  ${cycletype}  ${ordtype}
       </create>
      <create id="uk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}  ${cstype} ( ${clname} )
      </create>
      <create id="fk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
         REFERENCES ${rscname}.${rtbname} ( ${rclname} )
      </create>
      <create id="ix">
      </create>
      <load id="cmd">
         vwload --table "${scname}.${tbname}" --fdelim "${fdelim}" --quote "'" ${dbname} ${fname}
      </load>
      <load id="cpvwl">
         COPY "${tbname}" VWLOAD FROM '${fname}' WITH ${attrib} ${attribsep} fdelim='${fdelim}', quote='"' , WORK_DIR='${wdname}'
      </load>
   </vectorwise>
   <vector>
      <create id="sch">
         SET SESSION AUTHORIZATION ${scname}
      </create>
      <create id="pre">
         SET SESSION AUTHORIZATION ${scname};
         SET INSERTMODE ${insert_mode}
      </create>
      <create id="tb">
         CREATE TABLE ${scname}.${tbname} (
            ${clname}	${tyname}	${isnull} 	${dfval}
         ) WITH STRUCTURE = X100, NOPARTITION
       </create>
       <create id="drop">
         DROP TABLE IF EXISTS ${scname}.${tbname}
       </create>
       <create id="viw">
         DROP VIEW IF EXISTS ${scname}.${tbname}
       </create>
       <create id="seq">
         CREATE SEQUENCE ${scname}.${seqname} `
            ${clname} AS ${tyname} START WITH ${initv} INCREMENT BY  ${incv} MAXVALUE ${maxv} MINVALUE ${minv} ${seqtype} ${cachetype}  ${cycletype}  ${ordtype}
       </create>
      <create id="uk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname} ${cstype} ( ${clname} ) ${delname}

      </create>
      <create id="fk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
         REFERENCES ${rscname}.${rtbname} ( ${rclname} )  ${delname}

      </create>
      <create id="ix">
      </create>
      <load id="cmd">
         vwload --table "${scname}.${tbname}" --fdelim "${fdelim}" --quote "'" ${dbname} ${fname}
      </load>
      <load id="cpvwl">
         COPY "${tbname}" VWLOAD FROM '${fname}' WITH ${attrib} ${attribsep} fdelim='${fdelim}', quote='"' , WORK_DIR='${wdname}'
      </load>
   </vector>
   <vectorh>
      <create id="sch">
         SET SESSION AUTHORIZATION ${scname}
      </create>
      <create id="pre">
         SET SESSION AUTHORIZATION ${scname}
         SET INSERTMODE ${insert_mode}
      </create>
      <create id="drop">
         DROP TABLE IF EXISTS ${scname}.${tbname}; 
      </create>
      <create id="tb">
         CREATE TABLE ${scname}.${tbname} (
            ${clname}	${tyname}	${isnull} 	${dfval} 
			) WITH STRUCTURE = X100, PARTITION=(HASH ON ${clname} 5 PARTITIONS)
       </create>
       <create id="viw">
         DROP VIEW IF EXISTS ${scname}.${tbname}; 
       </create>
       <create id="seq">
         CREATE SEQUENCE ${scname}.${seqname} `
            ${clname} AS ${tyname} START WITH ${initv} INCREMENT BY  ${incv} MAXVALUE ${maxv} MINVALUE ${minv} ${seqtype} ${cachetype}  ${cycletype}  ${ordtype}         
       </create>
      <create id="uk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}  ${cstype} ( ${clname} )
      </create>
      <create id="fk">
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
         REFERENCES ${rscname}.${rtbname} ( ${rclname} )
      </create>
      <create id="ix">
      </create>
      <load id="cmd">
         vwload --table ${scname}.${tbname} --fdelim "${fdelim}" --quote "'" ${dbname} ${fname}
      </load>
      <load id="cpvwl">
         COPY ${scname}.${tbname}() VWLOAD FROM '${fname}' WITH ${attrib} ${attribsep} fdelim='${fdelim}', quote='"' , WORK_DIR='${wdname}'
      </load>
   </vectorh>

  <ingres>
        <create id="sch">
         SET SESSION AUTHORIZATION ${scname}
      </create>
      <create id="pre">
         SET SESSION AUTHORIZATION ${scname}
         SET INSERTMODE ${insert_mode}
      </create>
      <create id="tb">
         CREATE TABLE ${scname}.${tbname} (
            ${clname}	${tyname}	${isnull} 	${dfval}
         ) WITH STRUCTURE = HEAP
       </create>
       <create id="drop">
         DROP TABLE IF EXISTS ${scname}.${tbname}
       </create>
       <create id="viw">
         DROP VIEW IF EXISTS ${scname}.${tbname}
       </create>
       <create id="seq">
         CREATE SEQUENCE ${scname}.${seqname} `
            ${clname} AS ${tyname} START WITH ${initv} INCREMENT BY  ${incv} MAXVALUE ${maxv} MINVALUE ${minv} ${seqtype} ${cachetype}  ${cycletype}  ${ordtype}         
       </create>
      <create id="uk">
	     ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}  ${cstype} ( ${clname} )
      </create>
      <create id="fk">
	     
         ALTER TABLE ${scname}.${tbname} ADD CONSTRAINT ${csname}	FOREIGN KEY ( ${clname} )
         REFERENCES ${rscname}.${rtbname} ( ${rclname} )
      </create>
      <create id="ix">
	     CREATE ${ixuniq} INDEX ${scname}.${ixname} ON ${scname}.${tbname} ( ${clname} )
      </create>
      <load id="cmd">
         vwload --table "${scname}.${tbname}" --fdelim "${fdelim}" --quote "'" ${dbname} ${fname}
      </load>
      <load id="cpvwl">
	     CREATE TABLE ${scname}.dummy_${tbname} AS SELECT * FROM  ${scname}.${tbname} WHERE 1 = 0 WITH STRUCTURE = X100
         COPY ${scname}.dummy_${tbname} VWLOAD FROM '${fname}' WITH ${attrib} ${attribsep} fdelim='${fdelim}', quote='"' , WORK_DIR='${wdname}'
         INSERT INTO "${scname}.${tbname}" SELECT * FROM ${scname}.dummy_${tbname}
		 DROP TABLE IF EXISTS ${scname}.dummy_${tbname}
      </load>
  </ingres>
  <zen>
    <select id="tbDefinition">
      SELECT c.TABLE_QUALIFIER as scname, c.TABLE_NAME as tbname, c.column_name as clname, c.type_name as  tyname, 
             c.PRECISION as precision, c.SCALE as scale,
         CASE  WHEN c.nullable = 0 THEN 'NOT NULL'   END as isnull,
        CASE  WHEN c."COLUMN_DEF"  != '' THEN  CASE  WHEN c."COLUMN_DEF" != 'NULL' THEN  c."COLUMN_DEF" ELSE NULL END ELSE '0' END as dfval
        FROM   dbo.fSQLColumns ('${schema_filter}', NULL , null) c, 
               dbo.fSQLTables ('${schema_filter}', null, null) t
      WHERE  c.TABLE_NAME = t.TABLE_NAME 
        AND  t.TABLE_TYPE = 'TABLE'  
      ORDER BY c.TABLE_QUALIFIER, c.table_name, c.column_name, c.ORDINAL_POSITION
    </select>
    <select id="viwDefinition">
      SELECT DISTINCT  (select distinct TABLE_QUALIFIER as scname from dbo.fSQLTables ('${schema_filter}', null, null)  ) scname, 
      u."Xv$Name" viwname, CONCAT(CONCAT(CONCAT('CREATE VIEW ',"Xv$Name"),' AS '),"Xv$Misc") viwdef, 0 viwchk , 0 viwupd
      FROM "X$View" u
      WHERE "Xv$Misc" NOT LIKE '%X$%'
      ORDER BY 1,2,3       
    </select>
    <select id="fkDefinition">
      SELECT s.fktable_qualifier as scname, s.fktable_name  as tbname, s.fk_name as csname, 
       s.fkcolumn_name as clname, 
       s.pktable_qualifier rscname, s.pktable_name as rtbname, s.pkcolumn_name as rclname
           FROM dbo.fSQLForeignKeys ('${schema_filter}',null,null) s
           WHERE s.fktable_name NOT IN (select pktable_name from dbo.fsqlprimarykeys('${schema_filter}', '%'))
           AND    ('${schema_filter}' = '' OR ('${schema_filter}' = s.fktable_qualifier))
      ORDER BY 1,2,3
    </select>
    <select id="ukDefinition">
     
 SELECT  distinct s.table_qualifier as scname, s.table_name  as tbname, s.pk_name as csname,
            'PRIMARY KEY' as cstype,
            concat(concat(concat (
            substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlprimarykeys ('${schema_filter}','%') c 
                 WHERE c.key_seq = 1 and c.table_name = s.table_name),3,20), 
            substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlprimarykeys ('${schema_filter}','%') c 
            WHERE c.key_seq = 2 and c.table_name = s.table_name),1,20)),
            ifnull(substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlprimarykeys ('${schema_filter}','%') c 
            WHERE c.key_seq = 3 and c.table_name = s.table_name),1,20),'')),'"' ) as clname
           FROM dbo.fsqlprimarykeys ('${schema_filter}','%') s
           ORDER BY 1,2,3
    </select>
    <select id="ixDefinition">

 SELECT  distinct s.table_qualifier as scname, s.table_name  as tbname, s.table_qualifier as iscname
            s.index_name as ixname, 
            'INDEX' as cstype,
            concat(concat(concat (
            substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlStatistics ('${schema_filter}','%') c 
                 WHERE c.seq_in_index = 1 and c.table_name = s.table_name),3,20), 
            substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlStatistics ('${schema_filter}','%') c 
            WHERE c.seq_in_index = 2 and c.table_name = s.table_name),1,20)),
            ifnull(substring((SELECT  concat( '","', c.column_name) as cols  FROM  dbo.fsqlStatistics ('${schema_filter}','%') c 
            WHERE c.seq_in_index = 3 and c.table_name = s.table_name),1,20),'')),'"' ) as clname
           FROM dbo.fsqlStatistics ('${schema_filter}','%', 1) s
           WHERE NON_UNIQUE = 1
           ORDER BY 1,2,3

      SELECT  s.name as iscname, i.name as ixname, 
             CASE  WHEN i.type      = 2 THEN 'BTREE' ELSE CAST(i.type AS VARCHAR(2))  END as ixtype, 
             CASE  WHEN i.is_unique = 1 THEN 'UNIQUE'                                 END as ixuniq,
                c.name as cname
      FROM   sys.schemas s, sys.objects o1,  sys.indexes i, sysindexkeys ik, syscolumns c
      WHERE  o1.schema_id            = s.schema_id
      AND    o1.type                 = 'U' 
      AND    o1.object_id            = i.object_id
      AND    i.is_primary_key       != 1
      AND    i.is_unique_constraint != 1 
      AND    i.index_id              = ik.indid
      AND    i.object_id             = ik.id
      AND    ik.id                   = c.id
      AND    ik.colid                = c.colid
      AND    ('${schema_filter}' = '' OR  '${schema_filter}' = s.name)
      ORDER BY 1,2,3, ik.keyno
    </select>
   </zen>
</dbmv>


